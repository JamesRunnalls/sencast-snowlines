<graph id="colloc-wvl">
    <version>1.0</version>
    <node id="collocateNode">
        <operator>Collocate</operator>
        <sources>
            <master>${source1}</master>
            <slave>${source2}</slave>
    	</sources>
        <parameters>
           	<renameMasterComponents>false</renameMasterComponents>
           	<renameSlaveComponents>false</renameSlaveComponents>
        </parameters>
    </node>
    <node id="bandMathNode">
        <operator>BandMaths</operator>
        <sources>
           	<source>collocateNode</source>
        </sources>
        <parameters>
    		<targetBands>
				<targetBand>
					<name>Rw400</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw400 &lt; 1000 then Rw400 else NaN</expression>
					<spectralWavelength>400</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw412</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw412 &lt; 1000 then Rw412 else NaN</expression>
					<spectralWavelength>412</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw443</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw443 &lt; 1000 then Rw443 else NaN</expression>
					<spectralWavelength>443</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw490</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw490 &lt; 1000 then Rw490 else NaN</expression>
					<spectralWavelength>490</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw510</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw510 &lt; 1000 then Rw510 else NaN</expression>
					<spectralWavelength>510</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw560</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw560 &lt; 1000 then Rw560 else NaN</expression>
					<spectralWavelength>560</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw620</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw620 &lt; 1000 then Rw620 else NaN</expression>
					<spectralWavelength>620</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw665</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw665 &lt; 1000 then Rw665 else NaN</expression>
					<spectralWavelength>665</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw681</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw681 &lt; 1000 then Rw681 else NaN</expression>
					<spectralWavelength>681</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw709</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw709 &lt; 1000 then Rw709 else NaN</expression>
					<spectralWavelength>709</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw754</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw754 &lt; 1000 then Rw754 else NaN</expression>
					<spectralWavelength>754</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw779</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw779 &lt; 1000 then Rw779 else NaN</expression>
					<spectralWavelength>779</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw865</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw865 &lt; 1000 then Rw865 else NaN</expression>
					<spectralWavelength>865</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>Rw1020</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>if Rw1020 &lt; 1000 then Rw1020 else NaN</expression>
					<spectralWavelength>1020</spectralWavelength>
					<validExpression>true</validExpression>
					<unit>dl</unit>
				</targetBand>
				<targetBand>
					<name>SZA</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>sza</expression>
				</targetBand>
				<targetBand>
					<name>SAA</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>saa</expression>
				</targetBand>
				<targetBand>
					<name>OZA</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>vza</expression>
				</targetBand>
				<targetBand>
					<name>OAA</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>vaa</expression>
				</targetBand>
				<targetBand>
					<name>bitmask</name>
					<type>int16</type>
					<noDataValue>NaN</noDataValue>
					<expression>bitmask</expression>
				</targetBand>
				<targetBand>
					<name>Rnir</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>Rnir</expression>
				</targetBand>
				<targetBand>
					<name>Rgli</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>Rgli</expression>
				</targetBand>
				<targetBand>
					<name>logchl</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>logchl</expression>
				</targetBand>
				<targetBand>
					<name>bbs</name>
					<type>float32</type>
					<noDataValue>NaN</noDataValue>
					<expression>bbs</expression>
				</targetBand>
				<targetBand>
					<name>pixel_classif_flags</name>
					<type>int16</type>
					<noDataValue>NaN</noDataValue>
					<expression>pixel_classif_flags</expression>
				</targetBand>
				<targetBand>
					<name>quality_flags</name>
					<type>uint32</type>
					<noDataValue>NaN</noDataValue>
					<expression>quality_flags</expression>
				</targetBand>
    		</targetBands>
		</parameters>
    </node>    
    <node id="writeNode">
        <operator>Write</operator>
            <sources>
            	<source>bandMathNode</source>
            </sources>
            <parameters>
                <file>${output}</file>
                <formatName>NetCDF-BEAM</formatName>
            </parameters>
    </node>
</graph>